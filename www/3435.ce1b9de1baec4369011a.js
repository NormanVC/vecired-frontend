(self.webpackChunkveciRed=self.webpackChunkveciRed||[]).push([[3435],{3435:(e,t,o)=>{"use strict";o.r(t),o.d(t,{EditarAcuerdoPageModule:()=>m});var a=o(8583),r=o(665),i=o(7823),n=o(7860),c=o(4762),s=o(639),u=o(6014),l=o(4267),d=o(2478);function h(e,t){if(1&e&&(s.TgZ(0,"ion-grid"),s.TgZ(1,"ion-card"),s._UZ(2,"img",26),s.qZA(),s.qZA()),2&e){const e=s.oxw();s.xp6(2),s.Q6J("src",e.tempImages,s.LSH)}}const g=[{path:"",component:(()=>{class e{constructor(e,t,o,a,r,i){this.acuerdosService=e,this.navCtrl=t,this.router=o,this.camera=a,this.alertasService=r,this.platform=i,this.today=new Date,this.minTime=new Date((new Date).setHours((new Date).getHours()-48)).toISOString(),this.acuerdo={titulo:"",descripcion:"",fecha:null,hora:null,duracion:null,opciones:{}}}ngOnInit(){this.plataforma=!this.platform.is("capacitor"),this.acuerdosService.Objeto.subscribe(e=>{e.tipo?this.acuerdo=e:0==e.tipo&&(this.acuerdo.opciones=e)})}mostrarOpciones(){this.acuerdosService.enviarDatos(this.acuerdo),this.router.navigate(["/main/tabs/editar-opciones"])}volverAtras(){this.navCtrl.navigateRoot("/main/tabs/acuerdos",{animated:!0}),this.acuerdo={titulo:"",descripcion:"",fecha:null,hora:null,duracion:null,opciones:{}}}galeria(){this.camera.getPicture({quality:50,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,sourceType:this.camera.PictureSourceType.PHOTOLIBRARY}).then(e=>{const t=window.Ionic.WebView.convertFileSrc(e);this.acuerdosService.subirImagen(e),this.tempImages=t},e=>{console.log(e)})}actualizar(){return(0,c.mG)(this,void 0,void 0,function*(){const e=new a.uU("en-US");this.acuerdo.fecha=e.transform(this.acuerdo.fecha,"YYYY-MM-dd"),null==this.validacion()&&((yield this.acuerdosService.actualizarAcuerdo(this.acuerdo))?(this.navCtrl.navigateRoot("/main/tabs/acuerdos",{animated:!0}),this.alertasService.presentToast("Acuerdo modificado exitosamente")):this.alertasService.presentToast("El acuerdo no pudo ser modificado"))})}validacion(){if(0==/(^[A-Za-z\xc1\xc9\xcd\xd3\xda\xe1\xe9\xed\xf3\xfa\xf1\xd10-9\xa1!\xbf?\-.,()=/@ ]{3,30})+$/g.test(this.acuerdo.titulo))return this.alertasService.alerta("El t\xedtulo del acuerdo no permite tener los caracteres ingresados. Con un m\xednimo de 3 caracteres y un m\xe1ximo de 30.");if(null==this.acuerdo.fecha)return this.alertasService.alerta("Debe seleccionar una d\xeda");const e=new Date(this.today);return e.setDate(e.getDate()-1),this.acuerdo.fecha<e.toISOString()?this.alertasService.alerta("El d\xeda seleccionado no debe ser anterior a la fecha actual"):this.acuerdo.fecha>new Date("2122-03-07").toISOString()?this.alertasService.alerta("El d\xeda seleccionado no debe superar el 07/03/2122"):null==this.acuerdo.hora?this.alertasService.alerta("Debe seleccionar una hora"):null==this.acuerdo.duracion?this.alertasService.alerta("Debe seleccionar una duracion"):this.acuerdo.duracion<1?this.alertasService.alerta("La duraci\xf3n del acuerdo no puede ser menor a 1 hora"):this.acuerdo.duracion>48?this.alertasService.alerta("La duraci\xf3n del acuerdo no puede ser mayor a 48 horas"):0==/(^[A-Za-z\xc1\xc9\xcd\xd3\xda\xe1\xe9\xed\xf3\xfa\xf1\xd10-9\xa1!\xbf?\-.,()=/@ ]{3,250})+$/g.test(this.acuerdo.descripcion)?this.alertasService.alerta("La descripci\xf3n del acuerdo no permite tener los caracteres ingresados. Con un m\xednimo de 3 caracteres y un m\xe1ximo de 250."):0===Object.keys(this.acuerdo.opciones).length?this.alertasService.alerta("Las opciones no pueden estar vacias"):null}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(u.U),s.Y36(i.SH),s.Y36(n.F0),s.Y36(l.V1),s.Y36(d.e),s.Y36(i.t4))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-editar-acuerdo"]],decls:63,vars:13,consts:[[1,"cabecera"],["slot","start"],[3,"click"],["name","arrow-back-outline","color","light"],["color","light",1,"vecired"],["slot","end"],["disabled",""],["padding",""],[1,"titulo"],[1,"ion-text-center"],["position","floating"],["type","text","minlength","3","maxlength","30","required","",3,"ngModel","ngModelChange"],[1,"caracteres"],["display-format","DD/MMMM/YYYY","picker-format","DD/MMMM/YYYY","month-names","Ene, Feb, Mar, Abr, May, Jun, Jul, Ago, Sep, Oct, Nov, Dic","max","2122-03-07","doneText","Aceptar","cancelText","Cancelar","required","",3,"min","ngModel","ngModelChange"],["display-format","HH:mm","picker-format","HH mm","doneText","Aceptar","cancelText","Cancelar","required","",3,"ngModel","ngModelChange"],["type","number","min","0","max","23","required","",3,"ngModel","ngModelChange"],["minlength","3","maxlength","250","required","",3,"ngModel","ngModelChange"],["detail","true",3,"click"],[3,"hidden"],[2,"width","100%","margin-top","3%"],["size","6"],[2,"margin-top","4.5%"],["expand","full","shape","round",2,"margin-bottom","9%",3,"click"],["slot","start","name","images"],[4,"ngIf"],["color","tertiary","shape","round","expand","full",3,"disabled","click"],[1,"formatoImagen",3,"src"]],template:function(e,t){1&e&&(s.TgZ(0,"ion-header"),s.TgZ(1,"ion-toolbar",0),s.TgZ(2,"ion-buttons",1),s.TgZ(3,"ion-button",2),s.NdJ("click",function(){return t.volverAtras()}),s._UZ(4,"ion-icon",3),s.qZA(),s.qZA(),s.TgZ(5,"ion-title",4),s._uU(6," VeciRed "),s.qZA(),s.TgZ(7,"ion-buttons",5),s.TgZ(8,"ion-button",6),s._UZ(9,"ion-icon"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(10,"ion-content",7),s.TgZ(11,"div",8),s.TgZ(12,"h4",9),s.TgZ(13,"b"),s._uU(14,"EDITAR ACUERDO"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(15,"ion-list"),s.TgZ(16,"ion-item"),s.TgZ(17,"ion-label",10),s.TgZ(18,"b"),s._uU(19,"T\xedtulo:"),s.qZA(),s.qZA(),s.TgZ(20,"ion-input",11),s.NdJ("ngModelChange",function(e){return t.acuerdo.titulo=e}),s.qZA(),s.qZA(),s.TgZ(21,"span",12),s._uU(22),s.qZA(),s.TgZ(23,"ion-item"),s.TgZ(24,"ion-label",10),s.TgZ(25,"b"),s._uU(26,"D\xeda:"),s.qZA(),s.qZA(),s.TgZ(27,"ion-datetime",13),s.NdJ("ngModelChange",function(e){return t.acuerdo.fecha=e}),s.qZA(),s.qZA(),s.TgZ(28,"ion-item"),s.TgZ(29,"ion-label",10),s.TgZ(30,"b"),s._uU(31,"Hora:"),s.qZA(),s.qZA(),s.TgZ(32,"ion-datetime",14),s.NdJ("ngModelChange",function(e){return t.acuerdo.hora=e}),s.qZA(),s.qZA(),s.TgZ(33,"ion-item"),s.TgZ(34,"ion-label",10),s.TgZ(35,"b"),s._uU(36,"Duraci\xf3n:"),s.qZA(),s.qZA(),s.TgZ(37,"ion-input",15),s.NdJ("ngModelChange",function(e){return t.acuerdo.duracion=e}),s.qZA(),s.qZA(),s.TgZ(38,"ion-item"),s.TgZ(39,"ion-label",10),s.TgZ(40,"b"),s._uU(41,"Descripci\xf3n:"),s.qZA(),s.qZA(),s.TgZ(42,"ion-textarea",16),s.NdJ("ngModelChange",function(e){return t.acuerdo.descripcion=e}),s.qZA(),s.qZA(),s.TgZ(43,"span",12),s._uU(44),s.qZA(),s.TgZ(45,"ion-item",17),s.NdJ("click",function(){return t.mostrarOpciones()}),s.TgZ(46,"ion-label"),s.TgZ(47,"b"),s._uU(48,"Opciones"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(49,"ion-item",18),s.TgZ(50,"ion-row",19),s.TgZ(51,"ion-col",20),s.TgZ(52,"ion-label",21),s.TgZ(53,"b"),s._uU(54,"Imagen:"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(55,"ion-col",20),s.TgZ(56,"ion-button",22),s.NdJ("click",function(){return t.galeria()}),s._UZ(57,"ion-icon",23),s._uU(58," Galer\xeda "),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(59,h,3,1,"ion-grid",24),s.qZA(),s.TgZ(60,"ion-button",25),s.NdJ("click",function(){return t.actualizar()}),s.ALo(61,"json"),s._uU(62," Editar "),s.qZA(),s.qZA()),2&e&&(s.xp6(20),s.Q6J("ngModel",t.acuerdo.titulo),s.xp6(2),s.hij("",30-t.acuerdo.titulo.length," caracteres restantes"),s.xp6(5),s.Q6J("min",t.minTime)("ngModel",t.acuerdo.fecha),s.xp6(5),s.Q6J("ngModel",t.acuerdo.hora),s.xp6(5),s.Q6J("ngModel",t.acuerdo.duracion),s.xp6(5),s.Q6J("ngModel",t.acuerdo.descripcion),s.xp6(2),s.hij("",250-t.acuerdo.descripcion.length," caracteres restantes"),s.xp6(5),s.Q6J("hidden",t.plataforma),s.xp6(10),s.Q6J("ngIf",t.tempImages),s.xp6(1),s.Q6J("disabled",t.acuerdo.titulo.length<3||t.acuerdo.descripcion.length<3||null==t.acuerdo.fecha||null==t.acuerdo.hora||t.acuerdo.duracion<1||"{}"==s.lcZ(61,11,t.acuerdo.opciones)))},directives:[i.Gu,i.sr,i.Sm,i.YG,i.gu,i.wd,i.W2,i.q_,i.Ie,i.Q$,i.pK,i.j9,r.wO,r.nD,r.Q7,r.JJ,r.On,i.x4,i.QI,i.as,i.g2,i.Nd,i.wI,a.O5,i.jY,i.PM],pipes:[a.Ts],styles:[".titulo[_ngcontent-%COMP%]{margin-top:-3%;font-family:monospace}.caracteres[_ngcontent-%COMP%]{font-size:small;margin-left:55%;color:grey}.formatoImagen[_ngcontent-%COMP%]{width:100%;height:250px}.cabecera[_ngcontent-%COMP%]{--background:linear-gradient(135deg,#110a3b,#2f32a0)}.vecired[_ngcontent-%COMP%]{color:#f0f8ff;font-weight:bolder;font-size:x-large;text-align:center}"]}),e})()}];let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[n.Bz.forChild(g)],n.Bz]}),e})(),m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[a.ez,r.u5,i.Pc,p]]}),e})()},6014:(e,t,o)=>{"use strict";o.d(t,{U:()=>l});var a=o(1841),r=o(639),i=o(2340),n=o(1929),c=o(4975),s=o(7905);const u=i.N.url;let l=(()=>{class e{constructor(e,t,o){this.http=e,this.usuarioService=t,this.fileTransfer=o,this.pagiaAcuerdos=0,this.Objeto=new n.t,this.nuevoAcuerdo=new r.vpe,this.acuerdoEliminado=new r.vpe}getAcuerdos(e=!1){e&&(this.pagiaAcuerdos=0);const t=new a.WM({UToken:this.usuarioService.userToken});return this.pagiaAcuerdos++,this.http.get(`${u}/acuerdos/?pagina=${this.pagiaAcuerdos}`,{headers:t})}crearAcuerdo(e){const t=new a.WM({UToken:this.usuarioService.userToken});return new Promise(o=>{this.http.post(`${u}/acuerdos`,e,{headers:t}).subscribe(e=>{this.nuevoAcuerdo.emit(e.acuerdo),o(!0)})})}enviarDatos(e,t){e.tipo=t,this.Objeto.next(e)}limpiar(e){this.Objeto.next(e)}actualizarAcuerdo(e){const t=new a.WM({UToken:this.usuarioService.userToken});return new Promise(o=>{this.http.post(`${u}/acuerdos/actualizar`,e,{headers:t}).subscribe(e=>{o(!!e.ok)})})}eliminarAcuerdo(e){const t=new a.WM({UToken:this.usuarioService.userToken});return new Promise(o=>{this.http.post(`${u}/acuerdos/actualizar`,e,{headers:t}).subscribe(e=>{e.ok?(this.acuerdoEliminado.emit(e.acuerdo),o(!0)):o(!1)})})}subirImagen(e){const t={fileKey:"imagenAcuerdo",headers:{UToken:this.usuarioService.userToken}};this.fileTransfer.create().upload(e,`${u}/acuerdos/upload`,t).then(e=>{console.log(e)}).catch(e=>{console.log("Fallo al subir imagen:",e)})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(a.eN),r.LFG(c.i),r.LFG(s.K))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},2478:(e,t,o)=>{"use strict";o.d(t,{e:()=>n});var a=o(4762),r=o(639),i=o(7823);let n=(()=>{class e{constructor(e,t){this.alertController=e,this.toastController=t}alerta(e){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"my-custom-class",message:e,buttons:[{text:"Ok",role:"cancel"}]});yield t.present(),yield t.onDidDismiss()})}alertaDecision(e){return(0,a.mG)(this,void 0,void 0,function*(){let t;const o=yield this.alertController.create({backdropDismiss:!1,message:e,buttons:[{text:"ACEPTAR",handler:()=>(o.dismiss(!0),!1)},{text:"Cancelar"}]});return yield o.present(),yield o.onDidDismiss().then(e=>{t=e}),t})}presentToast(e){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:e,position:"bottom",duration:1800})).present()})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(i.Br),r.LFG(i.yF))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);