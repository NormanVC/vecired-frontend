(self.webpackChunkveciRed=self.webpackChunkveciRed||[]).push([[574],{574:(t,o,n)=>{"use strict";n.r(o),n.d(o,{DetalleVotacionPageModule:()=>y});var i=n(8583),e=n(665),a=n(7823),s=n(7860),c=n(4762),r=n(7574),u=n(6465);const l=new(n(6102).v)(u.o);var d=n(9796);function h(t){const{subscriber:o,counter:n,period:i}=t;o.next(n),this.schedule({subscriber:o,counter:n+1,period:i},i)}var f=n(639),g=n(6014);let v=(()=>{class t{constructor(t,o,n){this.acuerdosService=t,this.router=o,this.navCtrl=n,this.votacionLanzada={},this.dateNow=new Date,this.milliSecondsInASecond=1e3,this.hoursInADay=24,this.minutesInAnHour=60,this.SecondsInAMinute=60}getTimeDifference(){this.timeDifference=this.votacionLanzada.fechaLanzada+this.votacionLanzada.duracion*this.milliSecondsInASecond*this.minutesInAnHour*this.SecondsInAMinute-(new Date).getTime(),this.timeDifference<0&&this.finVotacion(),this.allocateTimeUnits(this.timeDifference)}allocateTimeUnits(t){this.secondsToDday=Math.floor(t/this.milliSecondsInASecond%this.SecondsInAMinute),this.minutesToDday=Math.floor(t/(this.milliSecondsInASecond*this.minutesInAnHour)%this.SecondsInAMinute),this.hoursToDday=Math.floor(t/(this.milliSecondsInASecond*this.minutesInAnHour*this.SecondsInAMinute)%this.hoursInADay)}finVotacion(){this.votacionLanzada.estado=3,this.acuerdosService.eliminarAcuerdo(this.votacionLanzada),this.navCtrl.navigateRoot("/main/tabs/votaciones")}ngOnInit(){this.subscription=function(t=0,o=l){var n;return((0,d.k)(n=t)||!(n-parseFloat(n)+1>=0)||t<0)&&(t=0),o&&"function"==typeof o.schedule||(o=l),new r.y(n=>(n.add(o.schedule(h,t,{subscriber:n,counter:0,period:t})),n))}(1e3).subscribe(t=>{this.getTimeDifference()})}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(f.Y36(g.U),f.Y36(s.F0),f.Y36(a.SH))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-cuenta-regresiva"]],inputs:{votacionLanzada:"votacionLanzada"},decls:9,vars:12,consts:[[1,"acuerdo"],["lines","none",1,"item-content","ion-text-center"]],template:function(t,o){1&t&&(f.TgZ(0,"ion-card",0),f.TgZ(1,"ion-card-content"),f.TgZ(2,"ion-item",1),f.TgZ(3,"ion-label"),f.TgZ(4,"b"),f._uU(5),f.ALo(6,"number"),f.ALo(7,"number"),f.ALo(8,"number"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&t&&(f.xp6(5),f.lnq("",f.xi3(6,3,o.hoursToDday,"2.0"),":",f.xi3(7,6,o.minutesToDday,"2.0"),":",f.xi3(8,9,o.secondsToDday,"2.0")," | Horas restantes"))},directives:[a.PM,a.FN,a.Ie,a.Q$],pipes:[i.JJ],styles:[".acuerdo[_ngcontent-%COMP%]{margin-top:10px;box-shadow:0 .9 2em rgba(30,30,31,.932);background-color:#f4f5f8}.item-content[_ngcontent-%COMP%]{--ion-item-background:#0000!important}"]}),t})();var b=n(868),p=n(4975);function Z(t,o){if(1&t){const t=f.EpF();f.TgZ(0,"ion-list",15),f.TgZ(1,"ion-item",16),f.NdJ("click",function(){const o=f.CHM(t).index;return f.oxw().buttonValue=o}),f.TgZ(2,"ion-label",7),f.TgZ(3,"b"),f._uU(4),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&t){const t=o.$implicit,n=o.index,i=f.oxw();f.xp6(1),f.Q6J("color",i.buttonValue==n?"secondary":"light"),f.xp6(3),f.Oqu(t.value.titulo)}}const m=[{path:"",component:(()=>{class t{constructor(t,o,n){this.acuerdosService=t,this.navCtrl=o,this.usuarioService=n,this.buttonValue=-1,this.votacion={titulo:"",descripcion:"",fecha:null,hora:null,duracion:0,opciones:{},votantes:[]},this.usuario={},this.ocultar=!0}ngOnInit(){this.acuerdosService.Objeto.subscribe(t=>{this.votacion=t}),this.obtenerUsuario()}mostrarInfo(){this.acuerdosService.enviarDatos(this.votacion),this.navCtrl.navigateRoot("/main/tabs/info")}votar(t){return(0,c.mG)(this,void 0,void 0,function*(){this.votacion.opciones[t].votos++,this.votacion.votantes.push(this.usuario._id);const o=yield this.acuerdosService.actualizarAcuerdo(this.votacion);o?(this.grafico.ngOnDestroy(),this.grafico.ngAfterViewInit(),this.ocultar=!1,this.buttonValue=-1):console.log("No se logra"+o)})}obtenerUsuario(){if(this.usuario=this.usuarioService.obtenerUsuario(),0!==this.votacion.votantes.length)for(let t=0;t<this.votacion.votantes.length;t++)this.usuario._id==this.votacion.votantes[t]&&(this.ocultar=!1);else this.ocultar=!0}ionViewWillEnter(){this.child.ngOnDestroy(),this.child.ngOnInit(),this.grafico.ngOnDestroy(),this.grafico.ngAfterViewInit(),this.obtenerUsuario()}ionViewDidLeave(){this.child.ngOnDestroy(),this.grafico.ngOnDestroy()}}return t.\u0275fac=function(o){return new(o||t)(f.Y36(g.U),f.Y36(a.SH),f.Y36(p.i))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-detalle-votacion"]],viewQuery:function(t,o){if(1&t&&(f.Gf(v,5),f.Gf(b.a,5)),2&t){let t;f.iGM(t=f.CRH())&&(o.child=t.first),f.iGM(t=f.CRH())&&(o.grafico=t.first)}},decls:27,vars:8,consts:[[1,"cabecera"],["slot","start"],["defaultHref","/main/tabs/votaciones","color","light"],["color","light",1,"vecired"],["slot","end"],["disabled",""],[1,"titulo"],[1,"ion-text-center"],[3,"graficoVotacion","hidden"],[1,"acuerdo",3,"hidden"],["style","background-color: #f4f5f8;",4,"ngFor","ngForOf"],[3,"votacionLanzada"],["size","6"],["color","tertiary","expand","full","shape","round",3,"click"],["color","tertiary","expand","full","shape","round",3,"disabled","click"],[2,"background-color","#f4f5f8"],[3,"color","click"]],template:function(t,o){1&t&&(f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar",0),f.TgZ(2,"ion-buttons",1),f._UZ(3,"ion-back-button",2),f.qZA(),f.TgZ(4,"ion-title",3),f._uU(5,"VeciRed"),f.qZA(),f.TgZ(6,"ion-buttons",4),f.TgZ(7,"ion-button",5),f._UZ(8,"ion-icon"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(9,"ion-content"),f.TgZ(10,"div",6),f.TgZ(11,"h4",7),f.TgZ(12,"b"),f._uU(13,"VOTACI\xd3N"),f.qZA(),f.qZA(),f.qZA(),f._UZ(14,"app-grafico",8),f.TgZ(15,"ion-card",9),f.TgZ(16,"ion-card-content"),f.YNc(17,Z,5,2,"ion-list",10),f.ALo(18,"keyvalue"),f.qZA(),f.qZA(),f._UZ(19,"app-cuenta-regresiva",11),f.TgZ(20,"ion-row"),f.TgZ(21,"ion-col",12),f.TgZ(22,"ion-button",13),f.NdJ("click",function(){return o.mostrarInfo()}),f._uU(23," Info "),f.qZA(),f.qZA(),f.TgZ(24,"ion-col",12),f.TgZ(25,"ion-button",14),f.NdJ("click",function(){return o.votar(o.buttonValue)}),f._uU(26," Votar "),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&t&&(f.xp6(14),f.Q6J("graficoVotacion",o.votacion)("hidden",o.ocultar),f.xp6(1),f.Q6J("hidden",!o.ocultar),f.xp6(2),f.Q6J("ngForOf",f.lcZ(18,6,o.votacion.opciones)),f.xp6(2),f.Q6J("votacionLanzada",o.votacion),f.xp6(6),f.Q6J("disabled",-1==o.buttonValue))},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.YG,a.gu,a.W2,b.a,a.PM,a.FN,i.sg,v,a.Nd,a.wI,a.q_,a.Ie,a.Q$],pipes:[i.Nd],styles:[".titulo[_ngcontent-%COMP%]{margin-top:-3%;font-family:monospace}.acuerdo[_ngcontent-%COMP%]{margin-top:10px;box-shadow:0 .9 2em rgba(30,30,31,.932);background-color:#f4f5f8}.cabecera[_ngcontent-%COMP%]{--background:linear-gradient(135deg,#110a3b,#2f32a0)}.vecired[_ngcontent-%COMP%]{color:#f0f8ff;font-weight:bolder;font-size:x-large;text-align:center}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[s.Bz.forChild(m)],s.Bz]}),t})();var T=n(5369);let y=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[i.ez,e.u5,a.Pc,A,T.r]]}),t})()}}]);